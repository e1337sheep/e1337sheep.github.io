'use strict';$(window).ready(function(){console.log('sport.js running'),initShares('sport'),$('a.share').map(function(h,j){return j.onclick=PopupHandler}),updateOGMeta('https://e1337sheep.github.io/infog/sport/images/sport.png'),updateSchema('sport'),updateSocialText('This is pre game, no score yet');
var b={},d=document.getElementById('sport'),e=d.getContext('2d'),f=initCanvasStatus();window.requestAnimationFrame(function(){return renderScene(f,e)});var g=f.addElement(initPreSpin());$('#wrapper img[id]').map(function(h,j){return b[grta.dashToCamel(j.id)]=j.src}),grta.preLoadImages(b,function(h){images=h,images.bungeeMan=grta.giveBorder(images.bungeeMan,2,'white'),d.onselectstart=function(){return!1},globStat=f,scaleFactor=grta.calcScale('sport'),[initSea,initFadeFish,initKayak,initWalker,initWalkers,initHoopBack,initBasketball,initHoopFront,initRunner,initBungeeMan,initHand,initGolfBalls].map(function(m){return f.addElement(m())});var j=f.elements.find(function(m){return'ballStage'===m.type});j.addBall(j,f),[{text:'You could moonwalk 27.5 miles',w:30,h:6,x:38,y:13},{text:'You could score 9516 three pointers',w:20,h:10,x:4,y:16},{text:'You could bungee-jump 94 times',w:31,h:6,x:1,y:40},{text:'You could swim the English Channel 3 times',w:40,h:6,x:1,y:86,rot:10},{text:'You could kayak 210 miles',w:25,h:6,x:47.5,y:86},{text:'You could run 157 miles',w:22,h:6,x:38.5,y:41}].map(function(m){f.addElement(initCaptionHTML(m.text,m.w,m.h,m.x,m.y,m.rot))}),g.finish(g,d),window.setInterval(function(){return f.addElement(initWalker())},2000),window.setInterval(function(){return f.addElement(initFadeFish())},3000),window.setInterval(function(){return j.addBall(j,f)},250);
var k=['xpos','ypos','scale','opacity','rotation'],l=new DeltaTimer(function(m){f=grta.updateElements(f,k,m)},1000/60);
l.start(),$('#sport').click(function(m){f.elements.filter(function(n){return!0==n.clickable}).map(function(n){n.hasClicked(n,m)&&n.on_click(n,m,f)})}),$(window).resize(function(m){scaleFactor=grta.calcScale('sport'),console.log(scaleFactor)}),TweenMax.to('#sport',0.8,{opacity:1}),TweenMax.to('#social-links h3',1,{textShadow:'1px 1px 10px rgba(255,255,255,1)                  ,-1px -1px 10px rgba(255,255,255,1)',yoyo:!0,repeat:-1,delay:20})})});
var initRunner=function initRunner(){var b=grta.createElement();return b.type='runningMan',b.image=images.runnerMan,b.imgWidth=b.image.width,b.imgHeight=b.image.height,b.xpos=200,b.ypos=60,b.initialScale=0.7,b},initHand=function initHand(){var b=grta.createElement();return b.type='hand',b.image=images.hand,b.imgWidth=b.image.width,b.imgHeight=b.image.height,b.gameID='highFive',b.captionID='high-five',b.showCaption=!0,b.preCaption='You could High Five 52,624 times.                      How many can you do in 22 seconds?',b.postCaption=function(d){return'You did '+d.score+' High Fives.  Think you can do better?'},b.on_gameEnd=function(d){updateSocialText('I did '+d.score+' High Fives.  Think you can do better?'),$('#social-links h3').html('Share your High Score of '+d.score+'!')},b.score=0,b.initialScale=0.5,b.xpos=470,b.ypos=30,b.rotationX=b.imgWidth/2-70,b.rotationY=b.imgHeight/2-20,b.rotation=1,TweenMax.to(b,0.5,{rotation:-b.rotation,ease:Quad.easeInOut,yoyo:!0,repeat:-1}),b.tween=TweenMax.to(b,7,{xpos:200,yoyo:!0,repeat:-1,ease:Quad.easeInOut,paused:!0}),b.returnTween=TweenMax.to(b,3,{xpos:470,paused:!0}),b.clickable=!0,b.clickAreas=[[67,150,99,274],[96,138,195,260]],initCaptionHTML(b.preCaption,24,18,73,25,0,b.captionID),b.on_click=function(d,e,f){'started'===f.gameStatus&&'highFive'===f.currentGame&&(f.score+=1,f.addElement(initFlyout(f.score,d.xpos+30,d.ypos+65))),'ready'===f.gameStatus&&(console.log('High Five Game Started'),f.currentGame='highFive',f.gameStatus='started',d.tween.restart(),TweenMax.to('#'+d.captionID,0.4,{opacity:0}),f.addElement(initClock(300,160)),f.score+=1,f.addElement(initFlyout(f.score,d.xpos+30,d.ypos+65))),TweenMax.to(d,0.05,{scale:0.9,yoyo:!0,repeat:1})},b.drawHand=b.draw,b.draw=function(d,e,f){d.drawHand(d,e,f)},b},initGolfBalls=function initGolfBalls(){var b=grta.createElement();return b.type='ballStage',b.gameID='golfBallShoot',b.captionID='golf-ball-shoot',b.preCaption='You could play 88 holes of golf.                        How many balls can you hit in 22 seconds?',b.postCaption=function(d){return'You hit '+d.score+' balls in 22 seconds.                                  Can you do better?'},b.on_gameEnd=function(d){updateSocialText('I hit '+d.score+' golf balls.  Can you do better?'),$('#social-links h3').html('Share your High Score of '+d.score+'!')},b.score=0,b.xpos=420,b.ypos=180,b.locations=[1,0,0,0,1,1,0,0,1,1,1,0,1,1,1,1,1,1,1,1],initCaptionHTML(b.preCaption,31.5,15,67,55,0,b.captionID),b.addBall=function(d,e){var f=!1;d.locations.map(function(g,h,j){var k=e.elements.filter(function(l){return'golf-ball'==l.type&&l.index==h}).length;if(k||2!=g||(j[h]=1),!f&&1==g){var l=initGolfBall();l.xpos=d.xpos+Math.floor(h/4)*(l.imgWidth*l.initialScale),l.ypos=d.ypos+h%4*(l.imgHeight*l.initialScale),l.index=h,e.addElement(l),f=!0,j[h]=2}})},b.draw=function(d,e,f){f.elements.filter(function(g){return'ballStage'===g.render}).map(function(g){return g.draw(g,e)})},b},initGolfBall=function initGolfBall(){var b=grta.createElement();return b.type='golf-ball',b.render='ballStage',b.image=images.golfBall,b.initialScale=0.3,b.imgHeight=b.image.height,b.imgWidth=b.image.width,b.rotationX=b.imgWidth/2-51,b.rotationY=b.imgHeight/2-51,b.tween=TweenMax.to(b,4,{rotation:360,ease:Power0.easeNone,repeat:-1}),b.opacity=0,b.opacityVel=+0.005,b.on_opacityLimitHi=function(d){return d.opacityVel=0,1},b.clickable=!0,b.clickAreas.push([0,0,b.imgWidth,b.imgHeight]),b.on_click=function(d,e,f){var g=f.elements.find(function(h){return'golfBallShoot'==h.gameID});'started'===f.gameStatus&&'golfBallShoot'===f.currentGame&&(f.score+=1,f.addElement(initFlyout(f.score,d.xpos,d.ypos))),'ready'===f.gameStatus&&(console.log('Starting Golf Game'),f.currentGame='golfBallShoot',f.gameStatus='started',TweenMax.to('#'+g.captionID,0.4,{opacity:0}),f.addElement(initClock(300,160)),f.score+=1,f.addElement(initFlyout(f.score,d.xpos,d.ypos))),d.yposVel=-0.8,d.yposFriction=+0.003,d.xposVel=-0.2,d.scaleVel=-0.002,d.aliveLimit=80},b.on_aliveLimit=function(d){d.remove=!0},b},initKayak=function initKayak(){var b=grta.createElement();return b.type='kayak',b.image=images.kayakPic,b.initialScale=0.7,b.imgHeight=b.image.height,b.imgWidth=b.image.width,b.xpos=640-b.imgWidth*b.initialScale-80,b.ypos=360-b.imgHeight*b.initialScale+4,b},initSea=function initSea(){var b=grta.createElement();return b.image=images.doverCalais,b.initialScale=1,b.imgHeight=b.image.height,b.imgWidth=b.image.width,b.type='sea',b.xpos=0,b.ypos=360-b.imgHeight*b.initialScale,b.drawBack=b.draw,b.draw=function(d,e,f){d.drawBack(d,e,f),f.elements.filter(function(g){return'fishStage'===g.render}).map(function(g){return g.draw(g,e)})},b},initCutoutSea=function initCutoutSea(){var b=grta.createElement();return b.image=images.doverCalais,b.images={top:images.doverCalaisTop,bottom:images.doverCalaisBot},b.imgHeight=b.image.height,b.imgWidth=b.image.width,b.type='sea',b.xpos=0,b.ypos=360-b.imgHeight,b.drawBack=b.draw,b.drawBackground=function(d,e,f){e.save(),e.translate(d.xpos,d.ypos),e.drawImage(d.images.bottom,0,0),e.restore()},b.drawForeground=function(d,e,f){e.save(),e.translate(d.xpos,d.ypos),e.drawImage(d.images.top,0,0),e.restore()},b.draw=function(d,e,f){d.drawBackground(d,e,f),f.elements.filter(function(g){return'fishStage'===g.render}).map(function(g){return g.draw(g,e)}),d.drawForeground(d,e,f)},b},initPaperFish=function initPaperFish(){var b=grta.createElement();b.type='fish',b.image=images.fish,b.imgHeight=b.image.height,b.imgWidth=b.image.width,b.xpos=50,b.ypos=282,b.xposVel=+0.01,b.yposVel=+0.002,b.xposLimits=[b.xpos,170],b.scale=0.4,b.rotation=11.5,b.render='fishStage';var d=document.createElement('canvas');d.width=b.imgWidth+6,d.height=b.imgHeight+6;var e=d.getContext('2d');
return e.fillStyle='yellow',e.fillRect(0,0,d.width,d.height),b.images={paper:d,fish:b.image},b.on_xposLimitHi=function(f){return f.remove=!0,f.xposLimits[1]},b.drawFish=b.draw,b.draw=function(f,g,h){g.save(),g.globalAlpha=f.opacity,g.translate(f.xpos,f.ypos),g.translate(f.imgWidth/2,f.imgHeight/2),g.rotate(f.rotation*Math.PI/180),g.translate(-f.imgWidth/2,-f.imgHeight/2),g.scale(f.trueScale(f),f.trueScale(f)),g.drawImage(f.images.paper,0,0),g.drawImage(f.image,f.frameOffset(f),0,f.imgWidth,f.imgHeight,0,0,f.imgWidth,f.imgHeight),g.restore()},b},initFadeFish=function initFadeFish(){var b=grta.createElement();return b.type='fish',b.image=images.fish,b.imgHeight=b.image.height,b.imgWidth=b.image.width,b.xpos=80,b.ypos=280,b.xposVel=+0.01,b.yposVel=+0.002,b.xposLimits=[75,145],b.scale=0.4,b.rotation=13,b.opacity=0,b.opacityVel=+0.005,b.render='fishStage',b.on_xposLimitHi=function(d){var e=d.xposLimits[1];return d.xposLimits=[75,160],d.opacityVel=-0.005,e},b.on_opacityLimitHi=function(d){return d.opacityVel=0,d.opacityLimits[1]},b.on_opacityLimitLo=function(d){d.yposVel=0,d.xposVel=0,d.remove=!0},b},initWalkers=function initWalkers(){var b=grta.createElement();return b.type='walkerStage',b.xpos=0,b.ypos=0,b.draw=function(d,e,f){f.elements.filter(function(g){return'walkerStage'===g.render}).map(function(g){return g.draw(g,e)})},b},initWalker=function initWalker(){var b=grta.createElement();return b.image=images.walkerSpritesheet,b.initialScale=0.7,b.isSprite=!0,b.frames=13,b.frameDelay=100,b.imgHeight=b.image.height,b.imgWidth=b.image.width/b.frames,b.type='walker',b.render='walkerStage',b.xpos=640,b.xposLimits=[-images.walker.width,640],b.xposVel=-0.1,b.on_xposLimitLo=function(d){return d.remove=!0,d.xposLimits[0]},b.ypos=0,b},initBungeeMan=function initBungeeMan(){var b=grta.createElement();return b.type='bungeeMan',b.image=images.bungeeMan,b.shadow=!0,b.imgHeight=b.image.height,b.imgWidth=b.image.width,b.xpos=0,b.ypos=120,b.initialScale=0.5,b.scale=0.05,b.clickable=!0,b.clickAreas=[[0,0,b.imgWidth,b.imgHeight]],b.rotationX=b.imgWidth/2,b.rotationY=b.imgHeight/2,b.on_click=function(d,e,f){TweenMax.to(d,2,{rotation:360,onComplete:function onComplete(){return d.rotation=0}})},b.tween=TweenMax.to(b,2,{scale:2,ease:Quad.easeInOut,yoyo:!0,repeat:-1}),b},initHoopBack=function initHoopBack(){var b=grta.createElement();return b.image=images.hoopBack,b.imgHeight=b.image.height,b.imgWidth=b.image.width,b.xpos=0,b.ypos=0,b.initialScale=0.4,b},initHoopFront=function initHoopFront(){var b=grta.createElement();return b.image=images.hoopFront,b.imgHeight=b.image.height,b.imgWidth=b.image.width,b.xpos=0,b.ypos=0,b.initialScale=0.4,b},initBasketball=function initBasketball(){var b=grta.createElement();return b.image=images.basketball,b.imgHeight=b.image.height,b.imgWidth=b.image.width,b.xpos=70,b.ypos=10,b.initialScale=0.8,b.rotationX=b.imgWidth/2-9,b.rotationY=b.imgHeight/2-9,b.tween=TweenMax.to(b,10,{rotation:360,ease:Power0.easeNone,repeat:-1}),b};
