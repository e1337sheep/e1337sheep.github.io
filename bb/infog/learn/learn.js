'use strict';$(window).ready(function(){console.log('learn.js running'),initShares('learn'),updateOGMeta('https://e1337sheep.github.io/infog/learn/images/learn.png'),updateSchema('learn'),updateSocialText('This is pre game, no score yet'),$('a.share').map(function(h,j){return j.onclick=PopupHandler});
var a={};$('#wrapper img[id]').map(function(h,j){return a[grta.dashToCamel(j.id)]=j.src});
var b=document.getElementById('learn'),e=b.getContext('2d'),f=initCanvasStatus();window.requestAnimationFrame(function(){return renderScene(f,e)});var g=f.addElement(initPreSpin());grta.preLoadImages(a,function(h){images=h,images.bird=grta.giveBorder(images.bird,2,'white',!1),b.onselectstart=function(){return!1},globStat=f,scaleFactor=grta.calcScale('learn'),[initEarth,initFalls,initNiagraTop,initNiagraBottom,initQuake,initMeteorStage,initTwisterStage,initBird,initAnteater,initStorm,initCloudBottom,initCloudTop,initEarthBoltStage,initTwister,initBatStage,initBat].map(function(n){return f.addElement(n())});
var j=[function(){return f.addElement(initWhale(400,210,390,290,380,340))},function(){return f.addElement(initWhale(420,210,420,310,420,340))},function(){return f.addElement(initWhale(440,210,440,320,440,340))},function(){return f.addElement(initWhale(460,210,440,330,430,340))},function(){return f.addElement(initWhale(480,210,470,330,460,340))},function(){return f.addElement(initWhale(500,210,490,330,480,340))},function(){return f.addElement(initWhale(520,210,510,330,500,340))},function(){return f.addElement(initWhale(540,210,530,330,520,340))},function(){return f.addElement(initWhale(560,213,540,333,520,343))},function(){return f.addElement(initWhale(580,213,560,333,540,343))}];
[{sx:150,sy:220,ex:150,ey:240,rot:60,d:0,s:1},{sx:190,sy:240,ex:210,ey:260,rot:20,d:0.2,s:0.9},{sx:190,sy:240,ex:190,ey:260,rot:60,d:0.1,s:0.8}].map(function(n){return f.addElement(initCloudBolt(n.sx,n.sy,n.ex,n.ey,n.rot,n.d,n.s))});
var k=[function(){return f.addElement(initMeteor(640,0,-200,170,1,0,1))},function(){return f.addElement(initMeteor(640,0,-200,170,1,0,1))},function(){return f.addElement(initMeteor(640,50,-200,500,0.5,-20,2))},function(){return f.addElement(initMeteor(640,50,-200,500,0.5,-20,2))},function(){return f.addElement(initMeteor(640,100,-200,-150,0.8,30,1.5))},function(){return f.addElement(initMeteor(640,100,-200,-150,0.8,30,1.5))},function(){return f.addElement(initMeteor(640,-100,-200,300,0.5,-10,2))}];
[{sx:420,sy:240,ex:430,ey:230,rot:-90,d:0,speed:1},{sx:400,sy:200,ex:410,ey:200,rot:-75,d:0.2,speed:1.1},{sx:390,sy:170,ex:410,ey:170,rot:-60,d:0.1,speed:0.8},{sx:380,sy:130,ex:400,ey:130,rot:-45,d:0,speed:0.7},{sx:380,sy:100,ex:400,ey:105,rot:-30,d:0.2,speed:1},{sx:390,sy:60,ex:410,ey:70,rot:-15,d:0.1,speed:0.7},{sx:420,sy:35,ex:430,ey:50,rot:-5,d:0,speed:1.1},{sx:460,sy:10,ex:470,ey:25,rot:10,d:0,speed:0.8},{sx:500,sy:0,ex:510,ey:15,rot:20,d:0.3,speed:0.8},{sx:540,sy:-20,ex:540,ey:15,rot:35,d:0,speed:0.7}].map(function(n){return f.addElement(initEarthBolt(n.sx,n.sy,n.ex,n.ey,n.rot,n.d,n.speed))}),[{x:320,y:0},{x:295,y:0},{x:270,y:0},{x:245,y:0},
{x:330,y:30},{x:305,y:30},{x:280,y:30},{x:255,y:30},{x:230,y:30},
{x:320,y:60},{x:295,y:60},{x:270,y:60},{x:245,y:60},{x:220,y:60},
{x:330,y:90},{x:305,y:90},{x:280,y:90},{x:255,y:90},{x:230,y:90},
{x:320,y:120},{x:295,y:120},{x:270,y:120},{x:245,y:120},{x:220,y:120}].map(function(n){return f.addElement(initBulb(n.x,n.y))}),[{x:-10,y:-10},{x:50,y:0},{x:150,y:0},{x:0,y:80},{x:40,y:120},{x:100,y:120},{x:150,y:100},{x:0,y:170},{x:80,y:170},{x:160,y:170},{x:220,y:200}].map(function(n){return f.addElement(initMoth(n.x,n.y))}),[{text:'A bat will eat around 1,000 insects.  How many can you eat?',w:30,h:10,x:3,y:30,rot:0},{text:'In the world there will be 7,200 earthquakes and more than         18,000 thunderstorms',w:30,h:15,x:5,y:70,rot:0},{text:'30,000 ants will be gobbled up by a South American Giant         Anteater',w:23,h:15,x:38,y:82,rot:0},{text:'A hummingbird will consume half of their weight in food',w:27,h:10,x:42,y:47,rot:30},{text:'One Billion gallons of water will tumble over Niagra falls         (that\'s just under 28,000 blue whales!)',w:30,h:15,x:68,y:82,rot:0},{text:'20 million meteors will be visible in the sky',w:16,h:15,x:80,y:30,rot:0},{text:'The Earth will be hit by lightning more than 8.6 million times',w:30,h:10,x:55,y:20,rot:-55},{text:'A hurricane will release enough energy for six months of         electricity',w:32,h:10,x:35,y:12,rot:-20}].map(function(n){f.addElement(initCaptionHTML(n.text,n.w,n.h,n.x,n.y,n.rot))}),g.finish(g,b),window.setInterval(function(){return j[Math.floor(Math.random()*j.length)]()},500),window.setInterval(function(){return k[Math.floor(Math.random()*k.length)]()},1000);
var l=['xpos','ypos','scale','opacity','rotation'],m=new DeltaTimer(function(n){f=grta.updateElements(f,l,n)},1000/60);
m.start(),$('#learn').click(function(n){f.elements.filter(function(o){return!0==o.clickable}).map(function(o){o.hasClicked(o,n)&&o.on_click(o,n,f)})}),$('#snap').click(function(n){console.log('Take a picture');var o=document.createElement('canvas');o.width=640,o.height=360;var p=o.getContext('2d');p.fillStyle='rgba(20,20,20,1)',p.fillRect(0,0,640,360),p.drawImage(b,0,0),document.getElementById('captions'),window.open(o.toDataURL('image/png'))}),$(window).resize(function(n){scaleFactor=grta.calcScale('learn')}),TweenMax.to('#learn',0.8,{opacity:1}),TweenMax.to('#social-links h3',1,{textShadow:'1px 1px 10px rgba(255,255,255,1)                  ,-1px -1px 10px rgba(255,255,255,1)',yoyo:!0,repeat:-1,delay:20})})});
var initBatStage=function initBatStage(){var a=grta.createElement();return a.type='batStage',a.draw=function(b,e,f){var g=f.elements.filter(function(j){return'batStage'===j.render}),h=g.find(function(j){return'bat'===j.type});h.draw(h,e,f),g.filter(function(j){return'moth'===j.type}).map(function(j){return j.draw(j,e,f)})},a},initBat=function initBat(){var a=grta.createElement();return a.type='bat',a.render='batStage',a.image=images.bat,a.imgWidth=a.image.width,a.imgHeight=a.image.height,a.initialScale=0.7,a.rotationX=a.imgWidth*a.initialScale/2,a.rotationY=a.imgHeight*a.initialScale/2,a.rotation=180,a.xpos=10,a},initMoth=function initMoth(a,b){var e=grta.createElement();return e.type='moth',e.render='batStage',e.image=images['moth-'+(Math.floor(5*Math.random())+1)],e.imgWidth=e.image.width,e.imgHeight=e.image.height,e.initialScale=0.25,e.rotationX=e.imgWidth*e.initialScale/2,e.rotationY=e.imgHeight*e.initialScale/2,e.rotation=Math.floor(360*Math.random()),e.xpos=a||0,e.ypos=b||0,TweenMax.to(e,0.1,{rotation:'+=4',ease:Linear.easeNone,repeat:-1,repeatDelay:Math.floor(5*Math.random())+1}),e},initTwisterStage=function initTwisterStage(){var a=grta.createElement();return a.type='tStage',a.draw=function(b,e,f){var g=f.elements.filter(function(j){return'tStage'===j.render}),h=g.find(function(j){return'twister'===j.type});h.draw(h,e,f),g.filter(function(j){return'bulb'===j.type}).map(function(j){return j.draw(j,e,f)})},a},initTwister=function initTwister(){var a=grta.createElement();return a.type='twister',a.render='tStage',a.image=images.twister,a.imgWidth=a.image.width,a.imgHeight=a.image.height,a.initialScale=0.8,a.rotation=50,a.xpos=390,a.ypos=-60,a},initBulb=function initBulb(a,b){var e=grta.createElement();return e.type='bulb',e.render='tStage',e.image=images.bulb,e.imgWidth=e.image.width,e.imgHeight=e.image.height,e.initialScale=0.3,e.xpos=a||0,e.ypos=b||0,e},initQuake=function initQuake(){var a=grta.createElement();return a.type='quake',a.image=images.earthquake,a.imgWidth=a.image.width,a.imgHeight=a.image.height,a.initialScale=0.25,a.xpos=0,a.ypos=360-a.imgHeight*a.initialScale,a},initStorm=function initStorm(){var a=grta.createElement();return a.type='stormStage',a.draw=function(b,e,f){var g=f.elements.filter(function(k){return'stormStage'===k.render}),h=g.find(function(k){return'cloudBottom'===k.type}),j=g.find(function(k){return'cloudTop'===k.type});h.draw(h,e,f),g.filter(function(k){return'cloudBolt'===k.type}).map(function(k){return k.draw(k,e,f)}),j.draw(j,e,f)},a},initCloudBottom=function initCloudBottom(){var a=grta.createElement();return a.type='cloudBottom',a.render='stormStage',a.image=images.cloudBottom,a.imgWidth=a.image.width,a.imgHeight=a.image.height,a.initialScale=0.5,a.xpos=100,a.ypos=240,a},initCloudTop=function initCloudTop(){var a=grta.createElement();return a.type='cloudTop',a.render='stormStage',a.image=images.cloudTop,a.imgWidth=a.image.width,a.imgHeight=a.image.height,a.initialScale=0.5,a.xpos=100,a.ypos=240,a},initCloudBolt=function initCloudBolt(a,b,e,f,g,h,j){var k=grta.createElement();return k.type='cloudBolt',k.render='stormStage',k.image=images.bolt,k.imgWidth=k.image.width,k.imgHeight=k.image.height,k.initialScale=0.3,k.rotation=g,k.xpos=a,k.ypos=b,TweenMax.to(k,j,{xpos:e,ypos:f,ease:Power3.easeInOut,yoyo:!0,repeat:-1,delay:h}),k},initAnteater=function initAnteater(){var a=grta.createElement();return a.type='eater',a.image=images.anteater,a.imgWidth=a.image.width,a.imgHeight=a.image.height,a.initialScale=0.8,a.xpos=250,a.ypos=190,a},initBird=function initBird(){var a=grta.createElement();return a.type='bird',a.image=images.bird,a.imgWidth=a.image.width,a.imgHeight=a.image.height,a.initialScale=0.7,a.xpos=180,a.ypos=160,a.rotation=-20,TweenMax.to(a,0.5,{ypos:'-=8',ease:Quad.easeInOut,yoyo:!0,repeat:-1}),a},initEarth=function initEarth(){var a=grta.createElement();return a.type='earth',a.image=images.earth,a.imgWidth=a.image.width,a.imgHeight=a.image.height,a.initialScale=0.9,a.xpos=445,a.ypos=30,a},initMeteorStage=function initMeteorStage(){var a=grta.createElement();return a.type='mStage',a.draw=function(b,e,f){f.elements.filter(function(g){return'mStage'===g.render}).map(function(g){return g.draw(g,e,f)})},a},initMeteor=function initMeteor(a,b,e,f,g,h,j){var k=grta.createElement();return k.type='meteor',k.render='mStage',k.image=images.meteor,k.imgWidth=k.image.width,k.imgHeight=k.image.height,k.initialScale=0.7,k.scale=g,k.rotation=h,k.xpos=a,k.ypos=b,TweenMax.to(k,j,{xpos:e,ypos:f,onComplete:function onComplete(){k.remove=!0}}),k},initEarthBoltStage=function initEarthBoltStage(){var a=grta.createElement();return a.type='boltStage',a.draw=function(b,e,f){f.elements.filter(function(g){return'bStage'===g.render}).map(function(g){return g.draw(g,e,f)})},a},initEarthBolt=function initEarthBolt(a,b,e,f,g,h,j){var k=grta.createElement();return k.type='earthBolt',k.render='bStage',k.image=images.bolt,k.imgWidth=k.image.width,k.imgHeight=k.image.height,k.initialScale=0.2,k.rotation=g,k.xpos=a,k.ypos=b,TweenMax.to(k,j,{xpos:e,ypos:f,ease:Power3.easeInOut,yoyo:!0,repeat:-1,delay:h}),k},initFalls=function initFalls(){var a=grta.createElement();return a.type='fallStage',a.draw=function(b,e,f){var g=f.elements.filter(function(k){return'fallStage'===k.render}),h=g.find(function(k){return'fallTop'===k.type});h.draw(h,e,f),g.filter(function(k){return'whale'===k.type}).map(function(k){return k.draw(k,e,f)});var j=g.find(function(k){return'fallBottom'===k.type});j.draw(j,e,f)},a},initNiagraTop=function initNiagraTop(){var a=grta.createElement();return a.type='fallTop',a.render='fallStage',a.image=images.niagraTop,a.imgWidth=a.image.width,a.imgHeight=a.image.height,a.initialScale=0.4,a.xpos=640-a.imgWidth*a.initialScale,a.ypos=360-a.imgHeight*a.initialScale,a},initNiagraBottom=function initNiagraBottom(){var a=grta.createElement();return a.type='fallBottom',a.render='fallStage',a.image=images.niagraBottom,a.imgWidth=a.image.width,a.imgHeight=a.image.height,a.initialScale=0.4,a.xpos=640-a.imgWidth*a.initialScale,a.ypos=360-a.imgHeight*a.initialScale,a},initWhale=function initWhale(a,b,e,f,g,h){var j=grta.createElement();j.type='whale',j.render='fallStage',j.image=images.whale,j.imgWidth=j.image.width,j.imgHeight=j.image.height,j.initialScale=0.25,j.xpos=a,j.ypos=b,j.opacity=0;var k=new TimelineMax({onComplete:function onComplete(){return j.remove=!0}});return k.to(j,0.5,{opacity:1}).to(j,1,{xpos:e,ypos:f,ease:Linear.easeNone}).to(j,0.5,{opacity:0,ypos:h,ease:Power1.easeOut}),j};
